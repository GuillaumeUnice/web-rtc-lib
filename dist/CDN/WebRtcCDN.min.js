var WebRtcCDN=function(e){function n(s){if(t[s])return t[s].exports;var i=t[s]={exports:{},id:s,loaded:!1};return e[s].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){e.exports=t(2)},function(e,n,t){"use strict";var s=t(4),i=function(){function e(e,n,t){var i=this;this.url=e,this.channelID=n,this.userID=t,this.myRTCPeerConnection=this.getBrowserRTCConnectionObj(),this.wsJmsLib=new s.wsJmsLib,this.wsJmsLib.connect(e,function(){i.wsJmsLib.subscribe(n,i.dispatchMessage)})}return e.prototype.dispatchMessage=function(e){switch(e.type){case"request_web_rtc":this.userID!==e.user_id&&(this.tempRemoteDesc=e);break;case"ice_candidate_web_rtc":this.userID!==e.user_id&&this.listTempRemoteIceCandidate.push(e.message);break;case"response_web_rtc":this.userID!==e.user_id&&this.responseWebRTC(e.message)}},e.prototype.responseWebRTC=function(e){this.myRTCPeerConnection.setRemoteDescription(new RTCSessionDescription(e))},e.prototype.getBrowserRTCConnectionObj=function(){var e=null,n={optional:[]};return window.mozRTCPeerConnection?new mozRTCPeerConnection(e,n):window.webkitRTCPeerConnection?new webkitRTCPeerConnection(e,n):new RTCPeerConnection(e,n)},e.prototype.buildMessage=function(e,n){return{chatroom_id:this.channelID,user_id:this.userID,type:n,message:e}},e.prototype.sendIceCandidates=function(e){if(e.candidate){var n={sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate},t=this.buildMessage(n,"ice_candidate_web_rtc");this.wsJmsLib.send(JSON.stringify(t),this.channelID,function(){})}},e.prototype.getDescription=function(e){var n=this;this.myRTCPeerConnection.setLocalDescription(e,function(){n.listTempRemoteIceCandidate.forEach(function(e){n.myRTCPeerConnection.addIceCandidate(new RTCIceCandidate(e))});var t=n.buildMessage(e,"response_web_rtc");n.wsJmsLib.send(JSON.stringify(t),n.channelID,function(){})})},e.prototype.createStream=function(e,n,t){var s=this;navigator.getUserMedia(e,function(e){s.myRTCPeerConnection.addStream(e),n(e),s.myRTCPeerConnection.onicecandidate=s.sendIceCandidates,s.myRTCPeerConnection.onaddstream=function(e){t(e.stream)},s.tempRemoteDesc?s.myRTCPeerConnection.setRemoteDescription(new RTCSessionDescription(s.tempRemoteDesc),function(){s.myRTCPeerConnection.createAnswer(s.getDescription,function(e){return console.error(e)})},function(e){return console.error(e)}):s.myRTCPeerConnection.createOffer(function(e){s.myRTCPeerConnection.setLocalDescription(e);var n=s.buildMessage(e,"request_web_rtc");s.wsJmsLib.send(JSON.stringify(n),s.channelID,function(){})},function(e){console.error(e)})},function(e){return console.error(e)})},e.attachStream=function(e,n){n=attachMediaStream(n,e)},e}();n.WebRTCLib=i},function(e,n,t){"use strict";var s=t(1);n.WebRTCLib=s.WebRTCLib},function(e,n){var t=function(){function e(){this.connection={},this.session={},this.consumers={}}return e.prototype.createDestination=function(n){var t=new RegExp(e.baseTopicUrl,"i"),s=new RegExp(e.baseQueueUrl,"i");if(n.match(t))return this.session.createTopic(n);if(n.match(s))return this.session.createQueue(n);throw new Error("Destination must start with /topic/ or /queue/")},e.prototype.buildMessage=function(e){var n=this.session.createTextMessage(e);return n},e.prototype.connect=function(e,n){var t=new JmsConnectionFactory(e),s=this,i=t.createConnection(function(){try{s.connection=i.getValue()}catch(e){console.error(e)}s.session=s.connection.createSession(!1,Session.AUTO_ACKNOWLEDGE),s.connection.start(function(){n()})})},e.prototype.subscribe=function(e,n){var t=this,s=this.session.createTopic(e),i=this.session.createConsumer(s);this.consumers[e]=i,i.setMessageListener(function(e){n.call(t,e.getText())})},e.prototype.send=function(e,n,t){var s=this.createDestination(n),i=this.session.createProducer(s),o=this.buildMessage(e);try{var r=i.send(o,function(){r.exception&&console.error(r.exception),t()})}catch(e){console.error(e)}i.close()},e.prototype.unsubscribe=function(e,n){var t=this.consumers[e];t&&(delete this.consumers[e],t.close(n))},e.baseTopicUrl="topic",e.baseQueueUrl="queue",e}();n.wsJmsLib=t},function(e,n,t){var s=t(3);n.wsJmsLib=s.wsJmsLib}]);
//# sourceMappingURL=WebRtcCDN.min.js.map